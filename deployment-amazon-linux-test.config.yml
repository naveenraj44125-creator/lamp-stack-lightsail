# Amazon Linux Test Deployment Configuration
# Tests the new Amazon Linux support with a simple LAMP stack

# AWS Configuration
aws:
  region: us-east-1

# Lightsail Instance Configuration
lightsail:
  instance_name: amazon-linux-test-v5
  static_ip: ""  # Will be fetched automatically from AWS
  
  # Use Amazon Linux 2023 blueprint to test yum package manager
  blueprint_id: "amazon_linux_2023"  # Uses yum, ec2-user, apache web user
  bundle_id: "small_3_0"  # 2GB RAM, 2 vCPU, 60GB SSD

# Application Configuration
application:
  name: amazon-linux-lamp-test
  version: "1.0.0"
  type: "web"
  
  # Deploy the example LAMP application
  package_files:
    - "example-lamp-app/"
  package_fallback: true

# Dependencies Configuration - Test Amazon Linux package installation
dependencies:
  # Apache Web Server (will install httpd on Amazon Linux instead of apache2)
  apache:
    enabled: true
    config:
      document_root: "/var/www/html"
      server_name: "amazon-linux-test"
      
  # PHP (will install Amazon Linux compatible PHP packages)
  php:
    enabled: true
    config:
      version: "8.1"
      modules:
        - "php-fpm"
        - "php-mysql"
        - "php-curl"
        - "php-json"
        - "php-mbstring"
        
  # MySQL Database (will install mariadb on Amazon Linux)
  mysql:
    enabled: true
    config:
      root_password: "test_password_123"
      database_name: "testapp"
      database_user: "appuser"
      database_password: "app_password_123"
      
  # Firewall (will use appropriate firewall commands for Amazon Linux)
  firewall:
    enabled: true
    config:
      allowed_ports:
        - "22"    # SSH
        - "80"    # HTTP
        - "443"   # HTTPS

# Deployment Configuration
deployment:
  use_docker: false
  steps:
    verification:
      port: 80
      endpoints_to_test:
        - "/"
        - "/index.php"

# Monitoring Configuration
monitoring:
  health_check:
    enabled: true
    port: 80
    path: "/"

# GitHub Actions Configuration
github_actions:
  jobs:
    test:
      enabled: true