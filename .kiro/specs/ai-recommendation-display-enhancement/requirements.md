# Requirements Document

## Introduction

This feature enhances the setup script's AI recommendation display to show the "★ AI" marker for database, bucket, and health endpoint selections. Currently, the `analyze_project_for_recommendations()` function correctly detects these recommendations and sets variables (`RECOMMENDED_DATABASE`, `RECOMMENDED_BUCKET`, `RECOMMENDED_HEALTH_ENDPOINT`), but the interactive prompts in `setup/08-interactive.sh` don't display them with the AI marker in the menus.

## Glossary

- **Setup_Script**: The modular bash script system that guides users through AWS Lightsail deployment configuration
- **AI_Recommendation**: A suggestion generated by analyzing the user's project code and configuration files
- **AI_Marker**: The "★ AI" visual indicator displayed next to recommended options in interactive menus
- **Project_Analysis**: The process of scanning project files to detect frameworks, databases, storage needs, and health endpoints
- **Interactive_Prompt**: A menu-based user interface element that presents options for user selection
- **Recommendation_Variable**: A bash variable (e.g., `RECOMMENDED_DATABASE`) set by the analysis function to store detected recommendations

## Requirements

### Requirement 1: Display AI Marker for Database Selection

**User Story:** As a developer running the setup script, I want to see the "★ AI" marker next to the recommended database option, so that I can quickly identify which database type matches my project.

#### Acceptance Criteria

1. WHEN the `analyze_project_for_recommendations()` function detects a database type AND the user reaches the database selection prompt, THEN the System SHALL display the "★ AI" marker next to the recommended database option
2. WHEN `RECOMMENDED_DATABASE` is set to "mysql", THEN the System SHALL display "★ AI" next to the "mysql" option in the database selection menu
3. WHEN `RECOMMENDED_DATABASE` is set to "postgresql", THEN the System SHALL display "★ AI" next to the "postgresql" option in the database selection menu
4. WHEN `RECOMMENDED_DATABASE` is "none" or empty, THEN the System SHALL NOT display any "★ AI" marker in the database selection menu
5. WHEN the AI marker is displayed for database selection, THEN the System SHALL set that option as the default selection

### Requirement 2: Display AI Marker for Bucket Configuration

**User Story:** As a developer running the setup script, I want to see the "★ AI" marker when bucket storage is recommended, so that I know my project likely needs file storage capabilities.

#### Acceptance Criteria

1. WHEN the `analyze_project_for_recommendations()` function detects file upload patterns AND `RECOMMENDED_BUCKET` is set to "true", THEN the System SHALL display the "★ AI" marker or message indicating bucket is recommended
2. WHEN `RECOMMENDED_BUCKET` is "true", THEN the System SHALL set the default answer to "yes" for the bucket enable prompt
3. WHEN `RECOMMENDED_BUCKET` is "false" or empty, THEN the System SHALL set the default answer to "no" for the bucket enable prompt
4. WHEN displaying the bucket recommendation, THEN the System SHALL show a message explaining why the bucket was recommended (e.g., "AI detected file upload patterns in your code")

### Requirement 3: Display AI Marker for Health Endpoint Detection

**User Story:** As a developer running the setup script, I want to see the detected health endpoint with an AI marker, so that I can use my existing health check endpoint instead of creating a new one.

#### Acceptance Criteria

1. WHEN the `analyze_project_for_recommendations()` function detects a health endpoint AND `RECOMMENDED_HEALTH_ENDPOINT` is set, THEN the System SHALL display the detected endpoint with a "★ AI" marker or message
2. WHEN a health endpoint is detected, THEN the System SHALL ask the user if they want to use the detected endpoint
3. WHEN the user confirms using the detected endpoint, THEN the System SHALL set `VERIFICATION_ENDPOINT` to the detected value
4. WHEN no health endpoint is detected, THEN the System SHALL proceed with the existing default behavior (prompt for custom endpoint or use "/")
5. WHEN displaying the detected health endpoint, THEN the System SHALL show the exact endpoint path found in the code

### Requirement 4: Maintain Consistency with Existing AI Markers

**User Story:** As a developer familiar with the setup script, I want all AI recommendations to be displayed consistently, so that I can easily identify AI-suggested options across all configuration steps.

#### Acceptance Criteria

1. WHEN displaying AI recommendations for database, bucket, and health endpoint, THEN the System SHALL use the same visual format as app type and instance size recommendations
2. WHEN the `select_option()` function is called with a recommendation type, THEN the System SHALL display the "★ AI" marker using the same color and formatting as existing markers
3. WHEN AI recommendations are displayed, THEN the System SHALL maintain the existing box-drawing characters and layout structure
4. THE System SHALL use the `YELLOW` color variable for all "★ AI" markers to ensure visual consistency

### Requirement 5: Preserve Automated Mode Behavior

**User Story:** As a developer using the setup script in automated mode, I want AI recommendations to work correctly without interactive prompts, so that my CI/CD pipelines continue to function properly.

#### Acceptance Criteria

1. WHEN `FULLY_AUTOMATED` mode is enabled, THEN the System SHALL NOT display interactive prompts for database, bucket, or health endpoint selection
2. WHEN `FULLY_AUTOMATED` mode is enabled AND environment variables are set, THEN the System SHALL use the environment variable values instead of AI recommendations
3. WHEN `FULLY_AUTOMATED` mode is enabled AND environment variables are NOT set, THEN the System SHALL use AI recommendations as defaults
4. THE System SHALL maintain backward compatibility with existing automated mode configurations

### Requirement 6: Update select_option Function for Database Support

**User Story:** As a developer maintaining the setup script, I want the `select_option()` function to support database recommendations, so that the AI marker displays correctly in the database menu.

#### Acceptance Criteria

1. WHEN the `select_option()` function is called with `recommendation_type` parameter "database", THEN the System SHALL check the `RECOMMENDED_DATABASE` variable
2. WHEN `RECOMMENDED_DATABASE` matches an option in the menu, THEN the System SHALL display the "★ AI" marker next to that option
3. WHEN `RECOMMENDED_DATABASE` matches an option, THEN the System SHALL update the default selection to that option
4. THE System SHALL handle the case where `RECOMMENDED_DATABASE` is "none" by not displaying any AI marker
